#!/usr/bin/env bash
set -euo pipefail

# Skip running when the commit itself is the automatic changelog commit (prevents recursion)
cd "$(git rev-parse --show-toplevel)"
LAST_MSG=$(git log -1 --pretty=%B)
if [[ "$LAST_MSG" == chore(changelog):* ]]; then
  exit 0
fi

if [ -x "./scripts/update-changelog.sh" ]; then
  ./scripts/update-changelog.sh
fi
